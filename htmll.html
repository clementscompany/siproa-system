<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <title>Painel de Processos</title>


  <style>
    .form-container {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
      border: 1px solid #e2e8f0;
      max-width: 950px;
      margin: 20px auto;
      font-family: "Poppins", sans-serif;
    }

    .form-container h2 {
      font-size: 1.3rem;
      color: #0d6efd;
      text-align: center;
      margin-bottom: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group label {
      font-weight: 600;
      color: #333;
      margin-bottom: 6px;
      font-size: 0.9rem;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      border: 1px solid #ced4da;
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 0.9rem;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      border-color: #0d6efd;
      outline: none;
      box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.15);
    }

    /* botões */
    .form-actions {
      margin-top: 20px;
      text-align: center;
    }

    .btn-submit {
      background: linear-gradient(135deg, #0d6efd, #0056d2);
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: 0.3s;
    }

    .btn-submit:hover {
      background: linear-gradient(135deg, #0056d2, #0b5ed7);
    }

    .btn-cancel {
      background: #e9ecef;
      color: #333;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-size: 0.9rem;
      cursor: pointer;
      margin-left: 10px;
      transition: 0.3s;
    }

    .btn-cancel:hover {
      background: #dee2e6;
    }
.tempo-group input {
  width: 100%;
  padding: 10px 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-family: "Poppins", sans-serif;
  font-size: 0.95em;
  transition: 0.3s;
}

.tempo-group input:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 4px rgba(13,110,253,0.3);
  outline: none;
}

  </style>
</head>

<body>
  <div class="form-container">
    <h2>Cadastro de Processo</h2>
    <form id="processoForm">
      <div class="form-grid">
        <div class="form-group">
          <label for="processo">Processo nº</label>
          <input type="text" id="processo" placeholder="Ex: 2025/0001">
        </div>

        <div class="form-group">
          <label for="cliente">Nome do Cliente / Empresa</label>
          <input type="text" id="cliente" placeholder="Ex: Transportes Global Lda.">
        </div>

        <div class="form-group">
          <label for="du">DU nº</label>
          <input type="text" id="du" placeholder="Ex: 548879-21">
        </div>

        <div class="form-group">
          <label for="descricao">Descrição da Mercadoria</label>
          <textarea id="descricao" rows="2" placeholder="Descreva a mercadoria..."></textarea>
        </div>

        <div class="form-group">
          <label for="data">Data</label>
          <input type="date" id="data">
        </div>

        <div class="form-group">
          <label for="situacao">Situação</label>
          <select id="situacao">
            <option value="">Selecione</option>
            <option value="pendente">Pendente</option>
            <option value="em-andamento">Em Andamento</option>
            <option value="concluido">Concluído</option>
          </select>
        </div>
        <div class="form-group tempo-group">
          <label for="tempo">Tempo (em horas ou dias)</label>
          <input type="text" id="tempo" placeholder="Ex: 48h ou 2d">
        </div>

        <div class="form-group">
          <label for="anexo1">Anexo 1</label>
          <input type="file" id="anexo1" accept=".pdf,.jpg,.png,.docx">
        </div>

        <div class="form-group">
          <label for="anexo2">Anexo 2</label>
          <input type="file" id="anexo2" accept=".pdf,.jpg,.png,.docx">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-submit">Salvar</button>
        <button type="reset" class="btn-cancel">Cancelar</button>
      </div>
    </form>
  </div>
  <script>
    document.getElementById("processoForm").addEventListener("submit", (e) => {
  e.preventDefault();

  const tempoInput = document.getElementById("tempo").value.trim();
  const tempoEmSegundos = converterParaSegundos(tempoInput);

  if (!tempoEmSegundos) {
    alert("Tempo inválido! Use formato como 2d, 5h, 30m ou 120s.");
    return;
  }

  // Simula o registro no banco
  const processo = {
    numero: document.getElementById("processo").value,
    cliente: document.getElementById("cliente").value,
    du: document.getElementById("du").value,
    descricao: document.getElementById("descricao").value,
    data: document.getElementById("data").value,
    situacao: document.getElementById("situacao").value,
    tempoRestante: tempoEmSegundos,
  };

  adicionarNaTabela(processo);
  e.target.reset();
});

// converte "2d", "5h", "30m" ou "120s" para segundos
function converterParaSegundos(valor) {
  const regex = /^(\d+)([dhms])$/i;
  const match = valor.match(regex);
  if (!match) return null;

  const quantidade = parseInt(match[1]);
  const unidade = match[2].toLowerCase();

  switch (unidade) {
    case "d": return quantidade * 86400;
    case "h": return quantidade * 3600;
    case "m": return quantidade * 60;
    case "s": return quantidade;
    default: return null;
  }
}

function formatarTempo(segundos) {
  const dias = Math.floor(segundos / 86400);
  const horas = Math.floor((segundos % 86400) / 3600);
  const minutos = Math.floor((segundos % 3600) / 60);
  const segs = segundos % 60;

  if (dias > 0) return `${dias}d ${horas}h ${minutos}m ${segs}s`;
  else return `${horas}h ${minutos}m ${segs}s`;
}

function adicionarNaTabela(processo) {
  const tbody = document.querySelector(".container-arquivos-tab tbody");
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td>${processo.numero}</td>
    <td>${processo.cliente}</td>
    <td>${processo.du}</td>
    <td>${processo.descricao}</td>
    <td>${processo.data}</td>
    <td>${processo.situacao}</td>
    <td class="tempo">${formatarTempo(processo.tempoRestante)}</td>
    <td><i class="bi bi-eye"></i> <i class="bi bi-pencil"></i> <i class="bi bi-printer"></i> <i class="bi bi-trash"></i></td>
  `;

  tbody.appendChild(tr);

  // inicia a contagem decrescente
  iniciarContagem(tr.querySelector(".tempo"), processo.tempoRestante);
}

function iniciarContagem(elemento, tempo) {
  let restante = tempo;

  const interval = setInterval(() => {
    restante--;
    elemento.textContent = formatarTempo(restante);

    if (restante <= 0) {
      clearInterval(interval);
      elemento.textContent = "Expirado";
      elemento.style.color = "red";
      elemento.closest("tr").style.background = "#ffe0e0";
    }
  }, 1000);
}

  </script>
</body>

</html>